<div class="container-fluid container-fluid-custom pb-5 mb-5">
  <div class="row mb-4">
    <div class="col">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/ongs">ONG's</a></li>
          <li class="breadcrumb-item active"><%= ong.nome_org %></li>
        </ol>
      </nav>
      <div class="col d-flex justify-content-between align-items-center">
        <h1 class="h3"><%= ong.nome_org %></h1>
        <button
        type="button"
        class="btn btn-danger me-2"
        onclick="confirmDelete('<%= ong._id %>')"
      >
          Excluir ONG
        </button>
      </div>
    </div>
  </div>

  <div class="card border-primary card-body" style="min-height: 210px">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-4 card-center"><img src="<%= ong.logo %>" /></div>
        <div class="col-md-8 card-center">
          <h5 class="card-title"><%= ong.nome_org %></h5>
          <p class="card-text"><%= ong.descricao %></p>
          <p class="card-text fw-bold"><%= ong.local %></p>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" tabindex="-1" role="dialog" id="deleteModal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Excluir ONG</h5>
        <button
          type="button"
          class="close"
          data-bs-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>
          Cancelar a OMG <b class="fw-bold"><%= ong.nome_org %></b><br />
          Você tem certeza?
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Fechar
        </button>
       
        <button type="button" class="btn btn-danger" onclick="deleteOng()">Excluir ONG</button>
      </div>
    </div>
  </div>
</div>

<script>
  let ongIdToDelete = null;
  function confirmDelete(id) {
    ongIdToDelete = id;
     new bootstrap.Modal(document.getElementById('deleteModal')).show();
  }

  function deleteOng() {
  if (!ongIdToDelete) return; 

  const url = `/ongs/${ongIdToDelete}`;
  console.log(`Fazendo a solicitação DELETE para: ${url}`);

  fetch(url, {
    method: 'DELETE',
    headers: {
      'Content-Type': 'application/json',
    },
  })
  .then(response => {
    if (response.ok) {
      return response.json();
    } else {
      throw new Error('Erro ao excluir a ONG');
    }
  })
  .then(data => {
  console.log(data.message);
  console.log('Redirecionando para /ongs');
    window.location.href = '/ongs';
  })
  .catch(error => {
    console.error('Erro na exclusão:', error);
  });
}
</script>
